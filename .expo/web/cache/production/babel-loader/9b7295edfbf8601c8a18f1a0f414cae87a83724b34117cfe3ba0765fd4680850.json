{"ast":null,"code":"import React,{useEffect,useState}from'react';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import ActivityIndicator from\"react-native-web/dist/exports/ActivityIndicator\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Dimensions from\"react-native-web/dist/exports/Dimensions\";import axios from'axios';import AsyncStorage from'@react-native-async-storage/async-storage';import{BarChart,PieChart,LineChart}from'react-native-chart-kit';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const screenWidth=Dimensions.get('window').width;const EstadisticasGraficas=()=>{const[estadisticas,setEstadisticas]=useState(null);const[trabajadorEstadisticas,setTrabajadorEstadisticas]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{const fetchEstadisticas=async()=>{try{const token=await AsyncStorage.getItem('token');if(!token){throw new Error('No token found');}const response=await axios.get('https://prestamos-back-production.up.railway.app/estadisticas/general',{headers:{Authorization:`Bearer ${token}`}});const trabajadorResponse=await axios.get('https://prestamos-back-production.up.railway.app/estadisticas/trabajadores',{headers:{Authorization:`Bearer ${token}`}});setEstadisticas(response.data);setTrabajadorEstadisticas(trabajadorResponse.data);setLoading(false);}catch(error){setError(error);setLoading(false);}};fetchEstadisticas();},[]);if(!estadisticas||!trabajadorEstadisticas){return _jsx(View,{children:_jsx(Text,{children:\"No se pudieron cargar las estad\\xEDsticas\"})});}const totalPrestamosActivos=estadisticas?estadisticas.filter(item=>item.estado==='pendiente').length:0;const totalPrestamosCompletados=estadisticas?estadisticas.filter(item=>item.estado==='completado').length:0;const barData=estadisticas&&estadisticas.length>0?{labels:estadisticas.map(item=>new Date(item.fecha_inicio).toLocaleDateString('es-ES',{month:'short'})),datasets:[{data:estadisticas.map(item=>Number(item.monto_inicial)||0),color:(opacity=1)=>`rgba(134, 65, 244, ${opacity})`}]}:{labels:[],datasets:[{data:[]}]};const pieData=[{name:'pendiente',population:totalPrestamosActivos,color:'rgba(131, 167, 234, 1)',legendFontColor:'#7F7F7F',legendFontSize:15},{name:'completado',population:totalPrestamosCompletados,color:'#F00',legendFontColor:'#7F7F7F',legendFontSize:15}];const lineData={labels:estadisticas?estadisticas.map(item=>new Date(item.fecha_inicio).toLocaleDateString('es-ES',{month:'short'})):[],datasets:[{data:estadisticas?estadisticas.map(item=>{const monto=Number(item.monto_inicial);return isNaN(monto)?0:monto;}):[],color:(opacity=1)=>`rgba(134, 65, 244, ${opacity})`,strokeWidth:2}],legend:['Monto Inicial']};return _jsxs(ScrollView,{style:styles.container,children:[_jsx(Text,{style:styles.chartTitle,children:\"Gr\\xE1fico de Barras\"}),_jsx(BarChart,{data:barData,width:screenWidth-20,height:300,yAxisLabel:\"$\",chartConfig:chartConfig,style:styles.chart}),_jsx(Text,{style:styles.chartTitle,children:\"Gr\\xE1fico de Pastel\"}),_jsx(PieChart,{data:pieData,width:screenWidth-20,height:300,chartConfig:chartConfig,accessor:\"population\",backgroundColor:\"transparent\",paddingLeft:\"15\",absolute:true,style:styles.chart}),_jsx(Text,{style:styles.chartTitle,children:\"Gr\\xE1fico de Tendencia\"}),_jsx(LineChart,{data:lineData,width:screenWidth-20,height:300,yAxisLabel:\"$\",chartConfig:chartConfig,style:styles.chart})]});};const chartConfig={backgroundColor:'#1cc910',backgroundGradientFrom:'#eff3ff',backgroundGradientTo:'#efefef',decimalPlaces:2,color:(opacity=1)=>`rgba(0, 0, 0, ${opacity})`,style:{borderRadius:16}};const styles=StyleSheet.create({container:{flex:1,padding:16,backgroundColor:'#ffffff'},chartTitle:{fontSize:18,fontWeight:'bold',marginTop:16,marginBottom:8,textAlign:'center'},chart:{marginVertical:8,borderRadius:16}});export default EstadisticasGraficas;","map":{"version":3,"names":["React","useEffect","useState","View","Text","ActivityIndicator","ScrollView","StyleSheet","Dimensions","axios","AsyncStorage","BarChart","PieChart","LineChart","jsx","_jsx","jsxs","_jsxs","screenWidth","get","width","EstadisticasGraficas","estadisticas","setEstadisticas","trabajadorEstadisticas","setTrabajadorEstadisticas","loading","setLoading","error","setError","fetchEstadisticas","token","getItem","Error","response","headers","Authorization","trabajadorResponse","data","children","totalPrestamosActivos","filter","item","estado","length","totalPrestamosCompletados","barData","labels","map","Date","fecha_inicio","toLocaleDateString","month","datasets","Number","monto_inicial","color","opacity","pieData","name","population","legendFontColor","legendFontSize","lineData","monto","isNaN","strokeWidth","legend","style","styles","container","chartTitle","height","yAxisLabel","chartConfig","chart","accessor","backgroundColor","paddingLeft","absolute","backgroundGradientFrom","backgroundGradientTo","decimalPlaces","borderRadius","create","flex","padding","fontSize","fontWeight","marginTop","marginBottom","textAlign","marginVertical"],"sources":["C:/prestamos/prestamos-front/components/EstadisticasGraficas.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { View, Text, ActivityIndicator, ScrollView, StyleSheet, Dimensions } from 'react-native';\nimport axios from 'axios';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { BarChart, PieChart, LineChart } from 'react-native-chart-kit';\n\nconst screenWidth = Dimensions.get('window').width;\n\nconst EstadisticasGraficas = () => {\n    const [estadisticas, setEstadisticas] = useState(null);\n    const [trabajadorEstadisticas, setTrabajadorEstadisticas] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n\n    useEffect(() => {\n        const fetchEstadisticas = async () => {\n            try {\n                const token = await AsyncStorage.getItem('token');\n                if (!token) {\n                    throw new Error('No token found');\n                }\n\n                const response = await axios.get('https://prestamos-back-production.up.railway.app/estadisticas/general', {\n                    headers: {\n                        Authorization: `Bearer ${token}`\n                    }\n                });\n\n                const trabajadorResponse = await axios.get('https://prestamos-back-production.up.railway.app/estadisticas/trabajadores', {\n                    headers: {\n                        Authorization: `Bearer ${token}`\n                    }\n                });\n\n                setEstadisticas(response.data);\n                setTrabajadorEstadisticas(trabajadorResponse.data);\n                setLoading(false);\n            } catch (error) {\n                setError(error);\n                setLoading(false);\n            }\n        };\n\n        fetchEstadisticas();\n    }, []);\n\n    if (!estadisticas || !trabajadorEstadisticas) {\n        return (\n            <View>\n                <Text>No se pudieron cargar las estadísticas</Text>\n            </View>\n        );\n    }\n    \n\n    const totalPrestamosActivos = estadisticas ? estadisticas.filter(item => item.estado === 'pendiente').length : 0;\n    const totalPrestamosCompletados = estadisticas ? estadisticas.filter(item => item.estado === 'completado').length : 0;\n\n    const barData = estadisticas && estadisticas.length > 0 ? {\n        labels: estadisticas.map(item => new Date(item.fecha_inicio).toLocaleDateString('es-ES', { month: 'short' })),\n        datasets: [\n            {\n                data: estadisticas.map(item => Number(item.monto_inicial) || 0),\n                color: (opacity = 1) => `rgba(134, 65, 244, ${opacity})`,\n            }\n        ]\n    } : {\n        labels: [],\n        datasets: [{ data: [] }]\n    };\n    \n    \n\n    const pieData = [\n        {\n            name: 'pendiente',\n            population: totalPrestamosActivos,\n            color: 'rgba(131, 167, 234, 1)',\n            legendFontColor: '#7F7F7F',\n            legendFontSize: 15,\n        },\n        {\n            name: 'completado',\n            population: totalPrestamosCompletados,\n            color: '#F00',\n            legendFontColor: '#7F7F7F',\n            legendFontSize: 15,\n        }\n    ];\n\n    const lineData = {\n        labels: estadisticas ? estadisticas.map(item => new Date(item.fecha_inicio).toLocaleDateString('es-ES', { month: 'short' })) : [],\n        datasets: [\n            {\n                data: estadisticas ? estadisticas.map(item => {\n                    const monto = Number(item.monto_inicial);\n                    return isNaN(monto) ? 0 : monto;\n                }) : [],\n                color: (opacity = 1) => `rgba(134, 65, 244, ${opacity})`,\n                strokeWidth: 2,\n            }\n        ],\n        legend: ['Monto Inicial'],\n    };\n    \n\n    return (\n        <ScrollView style={styles.container}>\n            <Text style={styles.chartTitle}>Gráfico de Barras</Text>\n            <BarChart\n                data={barData}\n                width={screenWidth - 20}\n                height={300}\n                yAxisLabel=\"$\"\n                chartConfig={chartConfig}\n                style={styles.chart}\n            />\n\n            <Text style={styles.chartTitle}>Gráfico de Pastel</Text>\n            <PieChart\n                data={pieData}\n                width={screenWidth - 20}\n                height={300}\n                chartConfig={chartConfig}\n                accessor=\"population\"\n                backgroundColor=\"transparent\"\n                paddingLeft=\"15\"\n                absolute\n                style={styles.chart}\n            />\n\n            <Text style={styles.chartTitle}>Gráfico de Tendencia</Text>\n            <LineChart\n                data={lineData}\n                width={screenWidth - 20}\n                height={300}\n                yAxisLabel=\"$\"\n                chartConfig={chartConfig}\n                style={styles.chart}\n            />\n        </ScrollView>\n    );\n};\n\nconst chartConfig = {\n    backgroundColor: '#1cc910',\n    backgroundGradientFrom: '#eff3ff',\n    backgroundGradientTo: '#efefef',\n    decimalPlaces: 2,\n    color: (opacity = 1) => `rgba(0, 0, 0, ${opacity})`,\n    style: { borderRadius: 16 },\n};\n\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n        padding: 16,\n        backgroundColor: '#ffffff'\n    },\n    chartTitle: {\n        fontSize: 18,\n        fontWeight: 'bold',\n        marginTop: 16,\n        marginBottom: 8,\n        textAlign: 'center'\n    },\n    chart: {\n        marginVertical: 8,\n        borderRadius: 16\n    },\n});\n\nexport default EstadisticasGraficas;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}