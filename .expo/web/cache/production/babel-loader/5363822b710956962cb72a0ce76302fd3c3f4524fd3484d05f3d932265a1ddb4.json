{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}import React,{useState,useEffect,useLayoutEffect}from'react';import View from\"react-native-web/dist/exports/View\";import FlatList from\"react-native-web/dist/exports/FlatList\";import Button from\"react-native-web/dist/exports/Button\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import TextInput from\"react-native-web/dist/exports/TextInput\";import Text from\"react-native-web/dist/exports/Text\";import axios from'axios';import AsyncStorage from'@react-native-async-storage/async-storage';import{useIsFocused}from'@react-navigation/native';import ClienteCard from'../components/ClienteCard';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const WorkerDashboard=({navigation})=>{const[clientes,setClientes]=useState([]);const[searchText,setSearchText]=useState('');const[filteredClientes,setFilteredClientes]=useState([]);const isFocused=useIsFocused();useEffect(()=>{const fetchClientes=async()=>{try{const token=await AsyncStorage.getItem('token');if(!token){console.error('No token found');return;}const response=await axios.get('https://prestamos-back-production.up.railway.app/clientes',{headers:{Authorization:`Bearer ${token}`}});const uniqueClientes=response.data.filter((cliente,index,self)=>index===self.findIndex(c=>c.id===cliente.id));console.log('Clientes recibidos:',uniqueClientes);setClientes(uniqueClientes);setFilteredClientes(uniqueClientes);}catch(error){console.error(error);}};if(isFocused){fetchClientes();}},[isFocused]);useEffect(()=>{const filtered=clientes.filter(cliente=>(cliente.estado!=='completado'||cliente.monto_actual===0)&&cliente.nombre.toLowerCase().includes(searchText.toLowerCase()));setFilteredClientes(filtered);},[searchText,clientes]);const handleLogout=async()=>{await AsyncStorage.removeItem('token');navigation.reset({index:0,routes:[{name:'Login'}]});};useLayoutEffect(()=>{navigation.setOptions({headerRight:()=>_jsx(View,{style:styles.buttonContainer,children:_jsx(Button,{onPress:handleLogout,title:\"Cerrar sesi\\xF3n\",color:\"red\"})})});},[navigation]);return _jsxs(View,{style:styles.container,children:[_jsx(Text,{style:styles.title,children:\"Lista de clientes\"}),_jsx(TextInput,{style:styles.searchInput,placeholder:\"Buscar cliente por nombre\",value:searchText,onChangeText:setSearchText,placeholderTextColor:\"#aaa\"}),_jsx(FlatList,{data:filteredClientes,keyExtractor:item=>item.id.toString(),renderItem:({item})=>_jsx(ClienteCard,{cliente:_objectSpread(_objectSpread({},item),{},{total_multas:item.total_multas!==undefined?item.total_multas:0}),onPress:()=>navigation.navigate('ClienteDetails',{id:item.id})})})]});};const styles=StyleSheet.create({container:{flex:1,backgroundColor:'#1c1c1e',padding:10},title:{fontSize:30,fontWeight:'bold',color:'#fff',marginBottom:10},buttonContainer:{width:125,height:38,margin:'end',marginRight:10,marginTop:10},searchInput:{height:40,borderColor:'#555',borderWidth:1,paddingHorizontal:8,borderRadius:4,color:'#fff',marginBottom:10,backgroundColor:'#fff'}});export default WorkerDashboard;","map":{"version":3,"names":["React","useState","useEffect","useLayoutEffect","View","FlatList","Button","StyleSheet","TextInput","Text","axios","AsyncStorage","useIsFocused","ClienteCard","jsx","_jsx","jsxs","_jsxs","WorkerDashboard","navigation","clientes","setClientes","searchText","setSearchText","filteredClientes","setFilteredClientes","isFocused","fetchClientes","token","getItem","console","error","response","get","headers","Authorization","uniqueClientes","data","filter","cliente","index","self","findIndex","c","id","log","filtered","estado","monto_actual","nombre","toLowerCase","includes","handleLogout","removeItem","reset","routes","name","setOptions","headerRight","style","styles","buttonContainer","children","onPress","title","color","container","searchInput","placeholder","value","onChangeText","placeholderTextColor","keyExtractor","item","toString","renderItem","_objectSpread","total_multas","undefined","navigate","create","flex","backgroundColor","padding","fontSize","fontWeight","marginBottom","width","height","margin","marginRight","marginTop","borderColor","borderWidth","paddingHorizontal","borderRadius"],"sources":["C:/prestamos/prestamos-front/screens/WorkerDashboard.jsx"],"sourcesContent":["import React, { useState, useEffect, useLayoutEffect } from 'react';\nimport { View, FlatList, Button, StyleSheet, TextInput, Text } from 'react-native';\nimport axios from 'axios';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { useIsFocused } from '@react-navigation/native';\nimport ClienteCard from '../components/ClienteCard';\n\nconst WorkerDashboard = ({ navigation }) => {\n    const [clientes, setClientes] = useState([]);\n    const [searchText, setSearchText] = useState('');\n    const [filteredClientes, setFilteredClientes] = useState([]);\n    const isFocused = useIsFocused();\n\n    useEffect(() => {\n        const fetchClientes = async () => {\n            try {\n                const token = await AsyncStorage.getItem('token');\n                if (!token) {\n                    console.error('No token found');\n                    return;\n                }\n\n                const response = await axios.get('https://prestamos-back-production.up.railway.app/clientes', {\n                    headers: {\n                        Authorization: `Bearer ${token}`\n                    }\n                });\n\n                const uniqueClientes = response.data.filter((cliente, index, self) =>\n                    index === self.findIndex((c) => (\n                        c.id === cliente.id\n                    ))\n                );\n\n                console.log('Clientes recibidos:', uniqueClientes);\n                setClientes(uniqueClientes);\n                setFilteredClientes(uniqueClientes);\n            } catch (error) {\n                console.error(error);\n            }\n        };\n\n        if (isFocused) {\n            fetchClientes();\n        }\n    }, [isFocused]);\n\n    useEffect(() => {\n        const filtered = clientes.filter(cliente =>\n            (cliente.estado !== 'completado' || cliente.monto_actual === 0) &&\n            cliente.nombre.toLowerCase().includes(searchText.toLowerCase())\n        );\n        setFilteredClientes(filtered);\n    }, [searchText, clientes]);\n\n    const handleLogout = async () => {\n        await AsyncStorage.removeItem('token');\n        navigation.reset({\n            index: 0,\n            routes: [{ name: 'Login' }],\n        });\n    };\n\n    useLayoutEffect(() => {\n        navigation.setOptions({\n            headerRight: () => (\n                <View style={styles.buttonContainer}>\n                    <Button\n                        onPress={handleLogout}\n                        title=\"Cerrar sesiÃ³n\"\n                        color=\"red\"\n                        \n                    />\n                </View>\n            ),\n        });\n    }, [navigation]);\n\n    return (\n        <View style={styles.container}>\n            <Text style={styles.title}>Lista de clientes</Text>\n            <TextInput\n                style={styles.searchInput}\n                placeholder=\"Buscar cliente por nombre\"\n                value={searchText}\n                onChangeText={setSearchText}\n                placeholderTextColor=\"#aaa\"\n            />\n            <FlatList\n                data={filteredClientes}\n                keyExtractor={item => item.id.toString()}\n                renderItem={({ item }) => (\n                    <ClienteCard\n                        cliente={{\n                            ...item,\n                            total_multas: item.total_multas !== undefined ? item.total_multas : 0\n                        }}\n                        onPress={() => navigation.navigate('ClienteDetails', { id: item.id })}\n                    />\n                )}\n            />\n        </View>\n    );\n};\n\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n        backgroundColor: '#1c1c1e',\n        padding: 10,\n    },\n    title: {\n        fontSize: 30,\n        fontWeight: 'bold',\n        color: '#fff',\n        marginBottom: 10,\n    },\n    buttonContainer: {\n        width: 125,\n        height: 38,\n        margin: 'end',\n        marginRight: 10,\n        marginTop: 10,\n    },\n    searchInput: {\n        height: 40,\n        borderColor: '#555',\n        borderWidth: 1,\n        paddingHorizontal: 8,\n        borderRadius: 4,\n        color: '#fff',\n        marginBottom: 10,\n        backgroundColor: '#fff',\n    },\n});\n\nexport default WorkerDashboard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}