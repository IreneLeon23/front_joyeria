{"ast":null,"code":"import React,{useState,useEffect,useLayoutEffect}from'react';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import TextInput from\"react-native-web/dist/exports/TextInput\";import FlatList from\"react-native-web/dist/exports/FlatList\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import axios from'axios';import AsyncStorage from'@react-native-async-storage/async-storage';import TrabajadorCard from'../components/TrabajadorCard';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminDashboard=({navigation})=>{const[trabajadores,setTrabajadores]=useState([]);const[searchText,setSearchText]=useState('');const[filteredTrabajadores,setFilteredTrabajadores]=useState([]);const fetchTrabajadores=async()=>{try{const token=await AsyncStorage.getItem('token');if(!token){throw new Error('Token no encontrado');}const response=await axios.get('https://prestamos-back-production.up.railway.app/trabajadores',{headers:{Authorization:`Bearer ${token}`}});setTrabajadores(response.data);setFilteredTrabajadores(response.data);}catch(error){console.error('Error al obtener trabajadores:',error);}};useEffect(()=>{fetchTrabajadores();const interval=setInterval(fetchTrabajadores,5000);return()=>clearInterval(interval);},[]);const handleLogout=async()=>{await AsyncStorage.removeItem('token');navigation.reset({index:0,routes:[{name:'Login'}]});};useLayoutEffect(()=>{navigation.setOptions({headerRight:()=>_jsx(TouchableOpacity,{style:styles.logoutButton,onPress:handleLogout,children:_jsx(Text,{style:styles.logoutButtonText,children:\"Cerrar sesi\\xF3n\"})})});},[navigation]);const handleSearch=text=>{setSearchText(text);if(text===''){setFilteredTrabajadores(trabajadores);}else{const filtered=trabajadores.filter(trabajador=>trabajador.nombre.toLowerCase().includes(text.toLowerCase()));setFilteredTrabajadores(filtered);}};return _jsxs(View,{style:styles.container,children:[_jsx(Text,{style:styles.title,children:\"Lista de trabajadores\"}),_jsx(TextInput,{style:styles.searchInput,placeholder:\"Buscar por nombre\",value:searchText,onChangeText:handleSearch}),_jsx(FlatList,{data:filteredTrabajadores,keyExtractor:item=>item.id.toString(),renderItem:({item})=>_jsx(TrabajadorCard,{trabajador:item,navigation:navigation})})]});};const styles=StyleSheet.create({container:{flex:1,padding:20,backgroundColor:'#1c1c1e'},title:{fontSize:24,fontWeight:'bold',color:'#fff',marginBottom:20},searchInput:{height:40,borderColor:'#ccc',borderWidth:1,borderRadius:5,marginBottom:20,paddingHorizontal:10,backgroundColor:'#fff',color:'#000'},logoutButton:{marginRight:15,paddingVertical:5,paddingHorizontal:10,backgroundColor:'#2e5c74',borderRadius:5},logoutButtonText:{color:'#fff',fontWeight:'bold'}});export default AdminDashboard;","map":{"version":3,"names":["React","useState","useEffect","useLayoutEffect","View","Text","TextInput","FlatList","StyleSheet","TouchableOpacity","axios","AsyncStorage","TrabajadorCard","jsx","_jsx","jsxs","_jsxs","AdminDashboard","navigation","trabajadores","setTrabajadores","searchText","setSearchText","filteredTrabajadores","setFilteredTrabajadores","fetchTrabajadores","token","getItem","Error","response","get","headers","Authorization","data","error","console","interval","setInterval","clearInterval","handleLogout","removeItem","reset","index","routes","name","setOptions","headerRight","style","styles","logoutButton","onPress","children","logoutButtonText","handleSearch","text","filtered","filter","trabajador","nombre","toLowerCase","includes","container","title","searchInput","placeholder","value","onChangeText","keyExtractor","item","id","toString","renderItem","create","flex","padding","backgroundColor","fontSize","fontWeight","color","marginBottom","height","borderColor","borderWidth","borderRadius","paddingHorizontal","marginRight","paddingVertical"],"sources":["C:/prestamos/prestamos-front/screens/AdminDashboard.jsx"],"sourcesContent":["import React, { useState, useEffect, useLayoutEffect } from 'react';\nimport { View, Text, TextInput, FlatList, StyleSheet, TouchableOpacity } from 'react-native';\nimport axios from 'axios';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport TrabajadorCard from '../components/TrabajadorCard';\n\nconst AdminDashboard = ({ navigation }) => {\n    const [trabajadores, setTrabajadores] = useState([]);\n    const [searchText, setSearchText] = useState('');\n    const [filteredTrabajadores, setFilteredTrabajadores] = useState([]);\n\n    const fetchTrabajadores = async () => {\n        try {\n            const token = await AsyncStorage.getItem('token');\n            if (!token) {\n                throw new Error('Token no encontrado');\n            }\n\n            const response = await axios.get('https://prestamos-back-production.up.railway.app/trabajadores', {\n                headers: {\n                    Authorization: `Bearer ${token}`\n                }\n            });\n            setTrabajadores(response.data);\n            setFilteredTrabajadores(response.data);\n        } catch (error) {\n            console.error('Error al obtener trabajadores:', error);\n        }\n    };\n\n    useEffect(() => {\n        fetchTrabajadores();\n        const interval = setInterval(fetchTrabajadores, 5000); // Polling cada 5 segundos\n        return () => clearInterval(interval); // Limpiar el intervalo cuando el componente se desmonte\n    }, []);\n\n    const handleLogout = async () => {\n        await AsyncStorage.removeItem('token');\n        navigation.reset({\n            index: 0,\n            routes: [{ name: 'Login' }],\n        });\n    };\n\n    useLayoutEffect(() => {\n        navigation.setOptions({\n            headerRight: () => (\n                <TouchableOpacity style={styles.logoutButton} onPress={handleLogout}>\n                    <Text style={styles.logoutButtonText}>Cerrar sesi√≥n</Text>\n                </TouchableOpacity>\n            ),\n        });\n    }, [navigation]);\n\n    const handleSearch = (text) => {\n        setSearchText(text);\n        if (text === '') {\n            setFilteredTrabajadores(trabajadores);\n        } else {\n            const filtered = trabajadores.filter(trabajador =>\n                trabajador.nombre.toLowerCase().includes(text.toLowerCase())\n            );\n            setFilteredTrabajadores(filtered);\n        }\n    };\n\n    return (\n        <View style={styles.container}>\n            <Text style={styles.title}>Lista de trabajadores</Text>\n            <TextInput\n                style={styles.searchInput}\n                placeholder=\"Buscar por nombre\"\n                value={searchText}\n                onChangeText={handleSearch}\n            />\n            <FlatList\n                data={filteredTrabajadores}\n                keyExtractor={item => item.id.toString()}\n                renderItem={({ item }) => (\n                    <TrabajadorCard trabajador={item} navigation={navigation} />\n                )}\n            />\n        </View>\n    );\n};\n\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n        padding: 20,\n        backgroundColor: '#1c1c1e', // Fondo oscuro\n    },\n    title: {\n        fontSize: 24,\n        fontWeight: 'bold',\n        color: '#fff',\n        marginBottom: 20,\n    },\n    searchInput: {\n        height: 40,\n        borderColor: '#ccc',\n        borderWidth: 1,\n        borderRadius: 5,\n        marginBottom: 20,\n        paddingHorizontal: 10,\n        backgroundColor: '#fff', // Fondo de entrada\n        color: '#000', // Color de texto\n    },\n    logoutButton: {\n        marginRight: 15,\n        paddingVertical: 5,\n        paddingHorizontal: 10,\n        backgroundColor: '#2e5c74', // Color de fondo\n        borderRadius: 5,\n    },\n    logoutButtonText: {\n        color: '#fff', // Color del texto\n        fontWeight: 'bold',\n    },\n});\n\nexport default AdminDashboard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}